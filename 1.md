
## 2分法 / Bisection method
- 対象：1変数関数 f(x)
- 目的：f(c) = 0をみたすcを求める
- 前提：f(a) f(b) < 0をみたす, あるa, bが既知
- 関連：関数の連続性, 中間値の定理

1. f(a) f(b) < 0となるようなa, bをみつける. εに小さな正数を代入する.
2. |b - a| < εならば終了（aまたはbが根）
3. c = (a + b)/2 として s = f(a) f(c)を計算する
4. s < 0 ならばbをcで置き換え, s > 0 ならばaをcで置き換えて2. に戻る.
[1]

```python
import math

# 定義
def f(x):
  return math.cos(x) - x**2

# 定数
e = 1e-6

# 既知
a = 0 # f(a) = 1.0
b = 1 # f(b) = -0.45969769413186023

print(f(a))
print(f(b))

# cの導出
i = 1
while e <= abs(b - a):
  c = (a + b) / 2
  print(i, a, b, c)

  s = f(a) * f(c)
  if s < 0:
    b = c
  else:
    a = c

  i += 1

print(c)
```

```
1.0
-0.45969769413186023
1 0 1 0.5
2 0.5 1 0.75
3 0.75 1 0.875
4 0.75 0.875 0.8125
5 0.8125 0.875 0.84375
6 0.8125 0.84375 0.828125
7 0.8125 0.828125 0.8203125
8 0.8203125 0.828125 0.82421875
9 0.8203125 0.82421875 0.822265625
10 0.822265625 0.82421875 0.8232421875
11 0.8232421875 0.82421875 0.82373046875
12 0.82373046875 0.82421875 0.823974609375
13 0.823974609375 0.82421875 0.8240966796875
14 0.8240966796875 0.82421875 0.82415771484375
15 0.8240966796875 0.82415771484375 0.824127197265625
16 0.824127197265625 0.82415771484375 0.8241424560546875
17 0.824127197265625 0.8241424560546875 0.8241348266601562
18 0.824127197265625 0.8241348266601562 0.8241310119628906
19 0.8241310119628906 0.8241348266601562 0.8241329193115234
20 0.8241310119628906 0.8241329193115234 0.824131965637207
0.824131965637207

```

[1] 数値計算入門[新訂版], 河村哲也
