
## 線形関数
f(x) = a (x - b) + c

直線。

## 非線形関数
線形じゃない関数。

f(x) = x^2

f(x) = sin(x)

f(x) = e^x

f(x) = 1 / (1 + e^{-x})


## 関数の連続性
lim_{x->a} f(x) = f(a) を満たすaが存在 → x=aで連続

[ref.三宅]

## 中間値の定理
f(x)が閉区間[a, b]において連続でf(a)≠f(b)ならば, f(a)とf(b)の間の任意の数lに対してf(c) = lとなるc(a < c < b)が必ず存在する. [ref.三宅]

## 2分法 / Bisection method
- 対象：1変数関数 f(x)
- 目的：f(c) = 0をみたすcを求める. このとき、cを根（コン）という.
- 前提：f(a) f(b) < 0をみたす, あるa, bが既知
- 関連：関数の連続性, 中間値の定理

1. f(a) f(b) < 0となるようなa, bをみつける. εに小さな正数を代入する.
2. |b - a| < εならば終了（aまたはbが根）
3. c = (a + b)/2 として s = f(a) f(c)を計算する
4. s < 0 ならばbをcで置き換え, s > 0 ならばaをcで置き換えて2. に戻る.
[ref.河村]

```python
import math

# 定義
def f(x):
  return math.cos(x) - x**2

# 定数
e = 1e-6

# 既知
a = 0 # f(a) = 1.0
b = 1 # f(b) = -0.45969769413186023

print(f(a))
print(f(b))

# cの導出
i = 1
while e <= abs(b - a):
  c = (a + b) / 2
  print(i, a, b, c)

  s = f(a) * f(c)
  if s < 0:
    b = c
  else:
    a = c

  i += 1

print(c)
```

```
1.0
-0.45969769413186023
1 0 1 0.5
2 0.5 1 0.75
3 0.75 1 0.875
4 0.75 0.875 0.8125
5 0.8125 0.875 0.84375
6 0.8125 0.84375 0.828125
7 0.8125 0.828125 0.8203125
8 0.8203125 0.828125 0.82421875
9 0.8203125 0.82421875 0.822265625
10 0.822265625 0.82421875 0.8232421875
11 0.8232421875 0.82421875 0.82373046875
12 0.82373046875 0.82421875 0.823974609375
13 0.823974609375 0.82421875 0.8240966796875
14 0.8240966796875 0.82421875 0.82415771484375
15 0.8240966796875 0.82415771484375 0.824127197265625
16 0.824127197265625 0.82415771484375 0.8241424560546875
17 0.824127197265625 0.8241424560546875 0.8241348266601562
18 0.824127197265625 0.8241348266601562 0.8241310119628906
19 0.8241310119628906 0.8241348266601562 0.8241329193115234
20 0.8241310119628906 0.8241329193115234 0.824131965637207
0.824131965637207

```

## はさみうち法 / False position method
- 対象：1変数関数 f(x)
- 目的：f(c) = 0をみたす根cを求める.
- 前提：f(a) f(b) < 0をみたす, あるa, bが既知
- 関連：2分法

2分法ではc=|a + b| / 2（a, bの中点）と定めたが, これをc=a f(b) - b f(a) / ( f(b) - f(a) )（( a, f(a) )と( b, f(b) )を結ぶ直線とx軸の交点）と定めたもの. 2分法, はさみうち法でそれぞれ方程式の形により収束の速さが変わるが, ふつうはあまり差がない.[ref.河村]

```python
import math

# 定義
def f(x):
  return math.cos(x) - x**2

# 定数
e = 1e-6

# 既知
a = 0 # f(a) = 1.0
b = 1 # f(b) = -0.45969769413186023

print(f(a))
print(f(b))

# cの導出
i = 1
while e <= abs(b - a):
  c = (a*f(b) - b*f(a)) / ( f(b) - f(a) )
  print(i, a, b, c)

  s = f(a) * f(c)
  if s < 0:
    b = c
  else:
    a = c

  i += 1

print(c)
```

```
1.0
-0.45969769413186023
1 0 1 0.6850733573260451
2 0.6850733573260451 1 0.81069364956815
3 0.81069364956815 1 0.8229316031819935
4 0.8229316031819935 1 0.8240258204057236
5 0.8240258204057236 1 0.8241228736524153
6 0.8241228736524153 1 0.8241314757794914
7 0.8241314757794914 1 0.8241322381640429
8 0.8241322381640429 1 0.8241323057318587
9 0.8241323057318587 1 0.824132311720185
10 0.824132311720185 1 0.8241323122509117
11 0.8241323122509117 1 0.8241323122979484
12 0.8241323122979484 1 0.824132312302117
13 0.824132312302117 1 0.8241323123024865
14 0.8241323123024865 1 0.8241323123025193
15 0.8241323123025193 1 0.8241323123025222
16 0.8241323123025222 1 0.8241323123025224
17 0.8241323123025224 1 0.8241323123025225
0.8241323123025225
```

## 2分法の2変数応用
- 対象：連立2元方程式 f_1(x, y) = 0, f_2(x, y) = 0
- 目的：実数解x, yを求める

## ニュートン法 / Newton's method
- 対象：1変数関数 f(x)
- 目的：f(c) = 0をみたす根cを求める.
- 前提：f(x)が微分可能

1. 出発地（初期値）x_0を適当に決める. n=0とする.
2. x_{n+1} = x_n - f(x_n) / f'(x_n)を用いてx_nからx_{n+1}を計算する.
3. |x_{n+1} - x_n| / |x_n| < ε が満たされれば終了. 満たされなければnを1増やして2.に戻る
[ref.河村]

```python
import math

# 定義
# f(x)
def f(x):
  return math.cos(x) - x**2

# f'(x)
def f_d(x):
  return -math.sin(x) - 2*x

# 定数
e = 1e-6

# 既知
x = 1

print(f(x))
print(f_d(x))

# cの導出
i = 1
while True:
  x_ = x - f(x)/f_d(x)
  print(i, x, x_)
  
  if abs(x_ - x) / abs(x) < e:
    break

  x = x_
  i += 1

print(x)
```

```
-0.45969769413186023
-2.8414709848078967
1 1 0.8382184099047068
2 0.8382184099047068 0.8242418682258743
3 0.8242418682258743 0.8241323190509289
4 0.8241323190509289 0.8241323123025225
0.8241323190509289
```

## 割線法 (Kassen hou) / Secant method
ニュートン法のf'(x)を微分の定義に基づいて近似して計算するもの。

f'(x_n) = lim_{h->0} { f(x_n + h) - f(x_n) } / h.

h = x_{n+1} - x_n と定義,

f'(x_n) = [ f(x_{n+1}) - f(x_n) ] / [ x_{n+1} - x_n ]

[ref.河村]

## テイラー展開

## ベアストウ法

## ガウスの消去法

## 掃き出し法

## LU分解法

## コレスキー法

## 変形コレスキー法

## トーマス法

## ヤコビ法

## ガウス・ザイデル法

## SOR法

- [ref.三宅] 入門微分積分, 三宅敏恒, 培風館, 1992
- [ref.河村] 数値計算入門[新訂版], 河村哲也, サイエンス社, 2018
